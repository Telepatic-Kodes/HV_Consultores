---
phase: 02-code-quality
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/__tests__/*.ts
  - eslint.config.mjs
autonomous: true

must_haves:
  truths:
    - "npm run build passes with zero errors"
    - "npx tsc --noEmit returns zero errors"
    - "ESLint 9 configured and passing"
  artifacts:
    - path: "package.json"
      provides: "Updated dependencies"
---

<objective>
Fix TypeScript compilation errors, upgrade ESLint to v9, and clean deprecated dependencies.

Purpose: Establish a clean baseline where `tsc --noEmit` passes with zero errors, ESLint runs on v9, and deprecated packages are removed.
Output: Zero TypeScript errors, ESLint 9 configured, deprecated packages cleaned.
</objective>

<tasks>

<task type="auto">
  <name>Fix TypeScript errors in test files</name>
  <files>
    src/__tests__/bank-rpa/rules-engine.test.ts
    src/__tests__/bank-rpa/sii-matcher.test.ts
    src/__tests__/phase6.test.ts
    src/__tests__/phase7-week2.test.ts
  </files>
  <action>
Fix the 9 TypeScript errors in test files:
- TS2322: Add missing required properties to test fixtures (created_at, etc.)
- TS2532/TS18048: Add null checks for possibly undefined objects
- TS2353: Fix unknown property references
- TS2367: Fix type comparison mismatches
  </action>
</task>

<task type="auto">
  <name>Upgrade ESLint to v9 and configure flat config</name>
  <files>
    package.json
    eslint.config.mjs
  </files>
  <action>
Upgrade ESLint from 8.56.0 to 9.x. Migrate from .eslintrc to flat config format.
Install eslint-config-next compatible with ESLint 9.
Run `npx eslint src/ --max-warnings 0` (or with reasonable limit).
  </action>
</task>

<task type="auto">
  <name>Clean deprecated and unnecessary packages</name>
  <files>
    package.json
  </files>
  <action>
Remove packages that are no longer used:
- Verify no @supabase/* packages remain
- Remove types/database.types.ts if only Supabase types
- Clean any other deprecated packages identified
  </action>
</task>

</tasks>
